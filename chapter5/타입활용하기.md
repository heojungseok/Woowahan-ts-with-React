# íƒ€ì… í™œìš©í•˜ê¸°

## ì¡°ê±´ë¶€ íƒ€ì…

### extendsì™€ ì œë„¤ë¦­ì„ í™œìš©í•œ ì¡°ê±´ë¶€ íƒ€ì…

#### ê¸°ë³¸ êµ¬ì¡°

```ts
T extends U ? X : Y
```

- Tê°€ Uë¥¼ ë§Œì¡±í•˜ë©´ X, ì•„ë‹ˆë©´ Yë¡œ í‰ê°€

#### ì˜ˆì‹œ

```ts
type ApiResponse<T> = T extends "success"
  ? { ok: true; data: any }
  : { ok: false; error: string };

function handleResponse<T extends "success" | "error">(
  status: T
): ApiResponse<T> {
  return status === "success"
    ? { ok: true, data: { name: "Kim" } }
    : { ok: false, error: "Unauthorized" };
}

const success = handleResponse("success");
// âœ… { ok: true; data: any }

const fail = handleResponse("error");
// âœ… { ok: false; error: string }

fail.error; // OK
fail.data; // âŒ Property 'data' does not exist
```

### ë§Œì•½ ì¡°ê±´ë¶€ íƒ€ì…ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ì„ ë•Œì˜ ë¬¸ì œì 

#### ì¡°ê±´ë¶€íƒ€ì…ì„ ì‚¬ìš©í•˜ì§€ ì•Šì€ ì½”ë“œ

```ts
function handleResponse(status: "success" | "error") {
  if (status === "success") {
    return { ok: true, data: { name: "Kim" } };
  } else {
    return { ok: false, error: "Unauthorized" };
  }
}

const result = handleResponse("success");
```

ìœ„ ê²½ìš° TSëŠ” resultì˜ íƒ€ì…ì„ **_ë‘ ê²½ìš°ë¥¼ ëª¨ë‘ í¬í•¨í•œ ìœ ë‹ˆì˜¨_**ìœ¼ë¡œ ì¶”ë¡ í•œë‹¤.

```ts
// resultì˜ íƒ€ì…
{
  ok: true;
  data: { name: string };
} | {
  ok: false;
  error: string;
}
```

ì´ë ‡ê²Œ í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

1. íƒ€ì…ì´ ëª¨í˜¸í•˜ì—¬ ifë¬¸ ì´í›„ì—ë„ narrowingì´ í•„ìš”í•¨

```ts
const result = handleResponse("success");

// âŒ ì˜¤ë¥˜: Property 'data' does not exist on type '{ ok: false; error: string; } | { ok: true; data: any; }'
console.log(result.data);
```

2. ë¶ˆí•„ìš”í•œ íƒ€ì… ë‹¨ì–¸ì´ í•„ìš”í•˜ë‹¤.

```ts
const result = handleResponse("success") as { ok: true; data: any };
console.log(result.data); // âœ… ë˜ì§€ë§Œ ê°•ì œ ë‹¨ì–¸ í•„ìš”
```

3. API í˜¸ì¶œ ë˜í¼ë‚˜ React Queryì—ì„œ ë¶ˆì•ˆì •í•˜ë‹¤.

```ts
const { data } = useQuery({
  queryKey: ["user"],
  queryFn: () => handleResponse("success"),
});

console.log(data.data); // âŒ Property 'data' does not exist on type ...
```

### inferë¥¼ í™œìš©í•˜ì—¬ íƒ€ì… ì¶”ë¡ í•˜ê¸°

inferëŠ” ì¡°ê±´ë¶€ íƒ€ì… ë‚´ë¶€ì—ì„œ íƒ€ì…ì„ ì¶”ë¡ (infer)í•´ì„œ ë³€ìˆ˜ì²˜ëŸ¼ êº¼ë‚´ì“°ëŠ” ë¬¸ë²•!

```ts
T extends SomeType<infer U> ? U : never
```

#### Promise ë‚´ë¶€ íƒ€ì… ì¶”ë¡  ì˜ˆì‹œ

```ts
type UnwrapPromise<T> = T extends Promise<infer U> ? U : T;

type A = UnwrapPromise<Promise<string>>; // âœ… string
type B = UnwrapPromise<number>; // âœ… number
```

- ì™œ ì‚¬ìš©í•˜ëƒ?
  - async function ê²°ê³¼ë¥¼ await ì—†ì´ íƒ€ì…ìœ¼ë¡œ ë‹¤ë£¨ê³  ì‹¶ì„ ë•Œ, í˜¹ì€ React Query, axios wrapper ë“±ì—ì„œ ì„œë²„ ì‘ë‹µ íƒ€ì…ì„ ì–»ì„ë•Œ ìì£¼ ì‚¬ìš©í•œë‹¤.

#### í•¨ìˆ˜ ë§¤ê°œë³€ìˆ˜ íƒ€ì… ì¶”ë¡  ì˜ˆì‹œ

```ts
type ParametersOf<T> = T extends (...args: infer P) => any ? P : never;

function setUser(id: number, name: string) {}
type Params = ParametersOf<typeof setUser>;
// âœ… [number, string]
```

- ì™œ ì‚¬ìš©í•˜ëƒ?
  - í•¨ìˆ˜ì˜ ì¸ì íƒ€ì…ì„ ê·¸ëŒ€ë¡œ ì¬ì‚¬ìš©í•  ë•Œ í¸ë¦¬í•˜ë‹¤.

#### ë¹„ë™ê¸° í•¨ìˆ˜ ë°˜í™˜ê°’ì˜ ë‚´ë¶€ ë°ì´í„° íƒ€ì… ì¶”ë¡  ì˜ˆì‹œ

```ts
type AsyncReturn<T> = T extends (...args: any[]) => Promise<infer U>
  ? U
  : never;

const getData = async () => ({ name: "Hwirin", age: 32 });

type Data = AsyncReturn<typeof getData>;
// âœ… { name: string; age: number }
```

- ì™œ ì‚¬ìš©í•˜ëƒ?
  - React Query, SWR, axios hooks ë“±ì—ì„œ ë¹„ë™ê¸° í•¨ìˆ˜ì˜ ì§„ì§œ ë°ì´í„° êµ¬ì¡°ë§Œ êº¼ë‚¼ë•Œ ì‚¬ìš©í•œë‹¤.

## í…œí”Œë¦¿ ë¦¬í„°ëŸ´ íƒ€ì… í™œìš©í•˜ê¸°

```ts
type Lang = "ko" | "en" | "jp";
type Key = "title" | "desc";

type LocaleKey = `${Lang}_${Key}`;

// "ko_title" | "ko_desc" | "en_title" | "en_desc" | "jp_title" | "jp_desc"
```

#### ë°°ë¯¼ í™œìš© ì˜ˆì‹œ

```ts
type Direction =
  | "top"
  | "topLeft"
  | "topRight"
  | "bottom"
  | "bottomLeft"
  | "bottomRight";
```

ìœ„ ì²˜ëŸ¼ ëª¨ë“  ë°©í–¥ì„ ì •ì˜í•˜ë©´ ë„ˆë¬´ ë§ê¸° ë•Œë¬¸ì— ì•„ë˜ì²˜ëŸ¼ ê°„ì†Œí™” ì‹œí‚¬ ìˆ˜ ìˆìŒ

```ts
type Vertical = "top" | "bottom";
type Horizon = "left" | "right";

type Direction = Vertical | `${Vertical}${Capitalize<Horizon>}`;
```

## ì»¤ìŠ¤í…€ ìœ í‹¸ë¦¬í‹° íƒ€ì… í™œìš©

### PickOne

```ts
type PickOne<T> = {
  [P in keyof T]: Record<P, T[P]> &
    Partial<Record<Exclude<keyof T, P>, undefined>>;
}[keyof T];
```

#### ìƒì„¸í•œ ì„¤ëª…

ë§Œì•½ ì•„ë˜ì™€ ê°™ì€ íŒŒì¼ ì—…ë¡œë“œë¥¼ ìœ„í•œ íƒ€ì…ì´ ìˆë‹¤ê³  í•´ë³´ì.

```ts
interface UploadConfig {
  url: string;
  file: File;
  base64: string;
}
```

ê·¸ëŸ°ë° ê°€ë” urlë§Œ ë„£ê±°ë‚˜, fileë§Œ ë„£ê±°ë‚˜ ì´ë ‡ê²Œ í•˜ë‚˜ë§Œ ë„£ê³ ì‹¶ì„ë•Œê°€ ìˆë‹¤.

#### [P in keyof T]

keyof TëŠ” "url" | "file" | "base64"ì²˜ëŸ¼
ê°ì²´ì˜ ëª¨ë“  í‚¤ ì´ë¦„ì„ ê°€ì ¸ì˜¨ë‹¤.

```ts
P = "url";
P = "file";
P = "base64";
```

#### Record<P, T[P]>

Record<key, value>ëŠ” â€œkey ì´ë¦„ì„ value íƒ€ì…ìœ¼ë¡œ ê°–ëŠ” ê°ì²´â€ë¥¼ ë§Œë“ ë‹¤.

```ts
Record<"url", string>; // => { url: string }
Record<"file", File>; // => { file: File }
Record<"base64", string>; // => { base64: string }
```

#### Exclude<keyof T, P>

ì´ê²ƒì€ ì§€ê¸ˆ í‚¤ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ í‚¤ë¥¼ êµ¬í•˜ëŠ”ê²ƒì´ë‹¤.  
ì˜ˆë¥¼ ë“¤ì–´ ì§€ê¸ˆ Pê°€ "url"ì´ë¼ë©´

```ts
Exclude<"url" | "file" | "base64", "url">;
```

ê²°ê³¼ëŠ” "file" | "base64"

#### Record<Exclude<keyof T, P>, undefined>

ì´ ì˜ë¯¸ëŠ” ë‚˜ë¨¸ì§€ í‚¤ë“¤ì„ undefinedë¡œ ë‘”ë‹¤ëŠ” ë§ì´ë‹¤.  
ìœ„ì— ì„¤ëª…í–ˆë˜ ì˜ˆì œëŒ€ë¡œ "file" | "base64"ë¥¼ ë„£ìœ¼ë©´

```ts
Record<"file" | "base64", undefined>;
// => { file: undefined; base64: undefined }
// â€œë‚˜ë¨¸ì§€ í‚¤ë“¤ì€ undefined íƒ€ì…ìœ¼ë¡œë§Œ í—ˆìš©í•œë‹¤â€ëŠ” ëœ».
```

#### Partial<Record<...>>

ìˆì–´ë„ ë˜ê³  ì—†ì–´ë„ ëœë‹¤(optional) ë¼ëŠ” ì˜ë¯¸ì´ë‹¤.  
ì§€ê¸ˆ ë§Œë“  { file: undefined; base64: undefined }ë¥¼ optionalë¡œ ë°”ê¾¸ë©´

```ts
{ file?: undefined; base64?: undefined }
```

#### & (êµì°¨íƒ€ì…)

ì´ê²ƒì€ ë‘˜ ë‹¤ ê°€ì§„ íƒ€ì…ì„ ì˜ë¯¸í•œë‹¤. ê·¸ë˜ì„œ ê²°ê³¼ì ìœ¼ë¡œ ë³´ë©´

```ts
Record<P, T[P]> & Partial<Record<Exclude<keyof T, P>, undefined>>;

/*
 * PickOne<UploadConfig> ê²°ê³¼
 * ---------------------------------
 * | P         | ê²°ê³¼ íƒ€ì… |
 * |------------|----------------------------------------------|
 * | "url"      | { url: string; file?: undefined; base64?: undefined } |
 * | "file"     | { file: File; url?: undefined; base64?: undefined }    |
 * | "base64"   | { base64: string; url?: undefined; file?: undefined }  |
 *
 * ì¦‰, ì„¸ ì†ì„± ì¤‘ **í•˜ë‚˜ë§Œ ê°€ì§ˆ ìˆ˜ ìˆê³ **, ë‚˜ë¨¸ì§€ëŠ” undefined ì—¬ì•¼ í•œë‹¤.
 */
```

#### ê°€ì¥ ì‰¬ìš´ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°

```ts
type Menu = {
  burger: Burger;
  pizza: Pizza;
  pasta: Pasta;
};
```

ìœ„ì²˜ëŸ¼ ì„¸ ê°œì˜ ë©”ë‰´ê°€ ìˆëŠ”ë°
`PickOne<Menu>`ëŠ”

- ë²„ê±°ë§Œ ì£¼ë¬¸í•˜ê±°ë‚˜ ğŸ”
- í”¼ìë§Œ ì£¼ë¬¸í•˜ê±°ë‚˜ ğŸ•
- íŒŒìŠ¤íƒ€ë§Œ ì£¼ë¬¸í•  ìˆ˜ ìˆê²Œ ğŸ ë§Œë“œëŠ” íƒ€ì…ì´ë‹¤.

<br>

- ë²„ê±°+í”¼ì ë™ì‹œ ì£¼ë¬¸ âŒ
- ì•„ë¬´ê²ƒë„ ì£¼ë¬¸ ì•ˆí•˜ëŠ” ê²ƒë„ âŒ

### NonNullableì„ í™œìš©í•œ íƒ€ì…ê°€ë“œ

NonNullableì„ í™œìš©í•˜ë©´ nullì´ë‚˜ undefinedê°€ ì„ì—¬ ìˆëŠ” ê°’ë“¤ì„ ì•ˆì „í•˜ê²Œ í•„í„°ë§í•˜ê±°ë‚˜ ê²€ì‚¬í•  ìˆ˜ ìˆë‹¤.

ë‚´ë¶€ì ìœ¼ë¡œëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ì´ë‹¤.

```ts
type NonNullable<T> = T extends null | undefined ? never : T;
```

#### ì‚¬ìš© ì˜ˆì‹œ

```ts
// ì´ í•¨ìˆ˜ëŠ” valueê°€ nullë„ ì•„ë‹ˆê³ , undefinedë„ ì•„ë‹ë•Œ trueë¥¼ ë°˜í™˜í•˜ëŠ” ë™ì‹œì— TSì—ê²Œ ì´ ê°’ì´ NonNullable<T> íƒ€ì…ì´ë‹¤ ë¼ê³  ì•Œë ¤ì£¼ëŠ” í•¨ìˆ˜ì´ë‹¤.
function isNonNullable<T>(value: T): value is NonNullable<T> {
  return value !== null && value !== undefined;
}

const arr = [1, null, 2, undefined, 3];
const result = arr.filter(isNonNullable);

// resultì˜ íƒ€ì…ì€ number[]
console.log(result); // [1, 2, 3]

// ì¦‰ ìœ„ í•¨ìˆ˜ëŠ” nullê³¼ undefinedì´ë©´ falseë¥¼ ë°˜í™˜í•˜ê³ , ì•„ë‹ë•ŒëŠ” í•´ë‹¹í•˜ëŠ” íƒ€ì…ìœ¼ë¡œ ì¢í˜€ì£¼ê²Œ ë˜ëŠ”ê²ƒì„!!
```

## ë¶ˆë³€ ê°ì²´ íƒ€ì…ìœ¼ë¡œ í™œìš©í•˜ê¸°

### as const ì‚¬ìš©

```ts
const colors = {
  red: "#F45452",
  green: "#0C952A",
  blue: "#1A7CFF",
};

const getColorHex = (key: string) => colors[key];
```

ìœ„ ì²˜ëŸ¼ stringìœ¼ë¡œ ì„¤ì •í•˜ë©´ getColorHexì˜ ë°˜í™˜ê°’ì´ anyê°€ ëœë‹¤. colorsì— ì–´ë–¤ ê°’ì´ ì¶”ê°€ë  ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì— ë‹¨ì–¸í•  ìˆ˜ ì—†ëŠ” ê²ƒì´ë‹¤.

ê·¸ë˜ì„œ `as const`ë¥¼ ë¶™ì—¬ì„œ ë¶ˆë³€ ê°ì²´ë¡œ ì„ ì–¸í•˜ê³  `keyof`ì—°ì‚°ìë¥¼ í™œìš©í•˜ì—¬ colorsê°ì²´ì— ìˆëŠ” keyê°’ë§Œ ë°›ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

```ts
const colors = {
  red: "#F45452",
  green: "#0C952A",
  blue: "#1A7CFF",
} as const;

const getColorHex = (key: string) => colors[key];
```

### keyofì™€ typeofë¡œ ë”°ë¼í•˜ê¸°

```ts
const colors = {
  red: "#F45452",
  green: "#0C952A",
  blue: "#1A7CFF",
};

type ColorsType = typeof colors; // ê°ì²´ì˜ íƒ€ì…ì„ ì¶”ì¶œ
type ColorKey = keyof ColorsType; // ê°ì²´ì˜ í‚¤ ì¶”ì¶œ

const getColorHex = (key: ColorKey) => colors[key];

// ColorsTypeì€ ì•„ë˜ì²˜ëŸ¼ í•´ì„ ëœë‹¤.
type ColorsType = {
  red: string;
  green: string;
  blue: string;
};

// ColorKeyëŠ” ì•„ë˜ì²˜ëŸ¼ í•´ì„ ëœë‹¤.
type ColorKey = "red" | "green" | "blue";
```

## Record ì›ì‹œ íƒ€ì… í‚¤ ê°œì„ í•˜ê¸°

Record<K,T>ëŠ” íŠ¹ì • í‚¤(K)ì§‘í•©ì— ëŒ€í•œ ë°¸ë¥˜ê°’ì˜ íƒ€ì…ì„ Të¡œ ì¼ì •í•˜ê²Œ ì§€ì •í•˜ëŠ” ë¬¸ë²•ì´ë‹¤.

ê·¸ëŸ°ë° ì—¬ê¸°ì„œ Kë¥¼ ì›ì‹œíƒ€ì…ìœ¼ë¡œ ì§€ì •í•˜ë©´ ë°œìƒí•˜ëŠ” ë¬¸ì œê°€ ìˆë‹¤.

```ts
type Category = string;
interface Food {
  name: string;
}

const foodByCategory: Record<Category, Food[]> = {
  í•œì‹: [{ name: "ì œìœ¡ë®ë°¥" }, { name: "ëšë°°ê¸° ë¶ˆê³ ê¸°" }],
  ì¼ì‹: [{ name: "ì´ˆë°¥" }, { name: "í…ë™" }],
};
```

ìœ„ ì˜ˆì‹œì—ì„œ CategoryëŠ” stringì´ê¸° ë•Œë¬¸ì— ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ì—¬ë„ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.

```ts
const ì–‘ì‹ë°°ì—´ = foodByCategory["ì–‘ì‹"]; //ì´ ê°’ì„ food[]ë¡œ ì¶”ë¡ í•˜ê²Œ ë¨
ì–‘ì‹ë°°ì—´.map((food) => console.log(food.name)); //ì´ë ‡ê²Œ í•´ë„ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠìŒ
```

ê·¸ëŸ¬ë‚˜ ë‹¹ì—°íˆ ì–‘ì‹ í‚¤ë¥¼ ê°€ì§„ ê°’ì€ ì—†ìœ¼ë¯€ë¡œ ëŸ°íƒ€ì„ì—ì„œ undefinedê°€ ë˜ì–´ mapì„ ëŒë¦¬ëŠ” ë¶€ë¶„ì—ì„œ ì˜¤ë¥˜ë¥¼ ë°˜í™˜í•˜ê²Œ ëœë‹¤.

ì´ë•Œ optional chainingì„ í†µí•´ ëŸ°íƒ€ì„ ì—ëŸ¬ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.

```ts
ì–‘ì‹ë°°ì—´?.map((food) => console.log(food.name));
```

í•˜ì§€ë§Œ ì´ëŠ” íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ì˜ë¯¸ê°€ ì „í˜€ ì—†ë‹¤.  
ì–´ë–¤ ê°’ì´ undefinedì¸ì§€ ë§¤ë²ˆ íŒë‹¨í•´ì•¼í•˜ê³ , ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

ê·¸ë˜ì„œ ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ì‚¬ìš©í•˜ê¸°ë¥¼ ê¶Œì¥í•œë‹¤.

### ìœ ë‹› íƒ€ì…ìœ¼ë¡œ ë³€ê²½í•˜ê¸°

```ts
type Category = "í•œì‹" | "ì¼ì‹";
interface Food {
  name: string;
}

const foodByCategory: Record<Category, Food[]> = {
  í•œì‹: [{ name: "ì œìœ¡ë®ë°¥" }, { name: "ëšë°°ê¸° ë¶ˆê³ ê¸°" }],
  ì¼ì‹: [{ name: "ì´ˆë°¥" }, { name: "í…ë™" }],
};
```

ì´ë ‡ê²Œ ì‚¬ìš©í•˜ë©´ ì–‘ì‹ì„ í‚¤ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ê°„ë‹¨íˆ í•´ê²° ê°€ëŠ¥í•˜ë‹¤.

í•˜ì§€ë§Œ í‚¤ê°€ ì •í•´ì§€ì§€ ì•Šì€ ìƒí™©ì—ì„œëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.

### Partialì„ í™œìš©í•œ ì •í™•í•œ íƒ€ì… í‘œí˜„

í‚¤ ê°’ì´ ì •í•´ì§€ì§€ ì•Šì€ ìƒí™©ì—ì„œëŠ” Partialì„ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ê°’ì´ undefinedì¼ ìˆ˜ ìˆë‹¤ëŠ” ìƒíƒœì„ì„ í‘œí˜„ì‹œì¼œì¤˜ì•¼ í•œë‹¤.

```ts
type PartialRecord<K extends string, T> = Partial<Record<K, T>>;
type Category = string;

interface Food {
  name: string;
}

const foodByCategory: PartialRecord<Category, Food[]> = {
  í•œì‹: [{ name: "ì œìœ¡ë®ë°¥" }, { name: "ëšë°°ê¸° ë¶ˆê³ ê¸°" }],
  ì¼ì‹: [{ name: "ì´ˆë°¥" }, { name: "í…ë™" }],
};

const ì–‘ì‹ë°°ì—´ = foodByCategory["ì–‘ì‹"]; // Food[]ë˜ëŠ” undefined íƒ€ì…ìœ¼ë¡œ ì¶”ë¡ í•œë‹¤.
ì–‘ì‹ë°°ì—´.map(); // undefinedê°€ í¬í•¨ë˜ê¸° ë•Œë¬¸ì— ë°”ë¡œ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. ë”°ë¼ì„œ ê°œë°œìë“¤ì€ ì´ê²ƒì„ ë³´ê³  ì˜µì…”ë„ ì²´ì´ë‹ì„ ë„£ì–´ì¤˜ì•¼í•œë‹¤ê³  íŒë‹¨í•  ìˆ˜ ìˆë‹¤.

ì–‘ì‹ë°°ì—´?.map(); // ì´ì œ ê°œë°œìëŠ” ì‹¤ìˆ˜ì—†ì´ undefinedê°€ ë‚˜ì˜¬ê±¸ ì˜ˆìƒí•˜ê³  ì˜µì…”ë„ ì²´ì´ë‹ì„ ì¶”ê°€í•œë‹¤.
```
